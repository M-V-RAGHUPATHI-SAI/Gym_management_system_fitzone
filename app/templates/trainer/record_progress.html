{% extends "base.html" %}

{% block title %}Record Progress - Trainer{% endblock %}

{% block content %}
<div class="max-w-4xl mx-auto">
    <!-- Page Header -->
    <div class="mb-6">
        <h1 class="text-3xl font-bold text-gray-900">
            <i class="fas fa-chart-line mr-3 text-primary"></i>Record Client Progress
        </h1>
        <p class="text-gray-600">{{ member.full_name }} - Progress Entry</p>
    </div>

    <!-- Last Record Card -->
    {% if last_record %}
    <div class="bg-white shadow-md rounded-2xl border border-gray-100 p-6 mb-8">
        <h2 class="text-xl font-semibold text-gray-900 mb-1 flex items-center">
            <i class="fas fa-history text-primary mr-2"></i>Last Recorded Progress
        </h2>
        <p class="text-sm text-gray-500 mb-4">{{ last_record.recorded_date | datetimeformat('%Y-%m-%d') }}</p>
        <div class="grid grid-cols-2 md:grid-cols-4 gap-4 text-sm">
            {% if last_record.weight %}
            <div>
                <span class="text-gray-500">Weight:</span>
                <span class="font-medium ml-1">{{ last_record.weight }}kg</span>
            </div>
            {% endif %}
            {% if last_record.bmi %}
            <div>
                <span class="text-gray-500">BMI:</span>
                <span class="font-medium ml-1">{{ last_record.bmi }}</span>
            </div>
            {% endif %}
            {% if last_record.body_fat_percentage %}
            <div>
                <span class="text-gray-500">Body Fat:</span>
                <span class="font-medium ml-1">{{ last_record.body_fat_percentage }}%</span>
            </div>
            {% endif %}
            {% if last_record.chest %}
            <div>
                <span class="text-gray-500">Chest:</span>
                <span class="font-medium ml-1">{{ last_record.chest }}cm</span>
            </div>
            {% endif %}
        </div>
    </div>
    {% endif %}

    <!-- Record Progress Form -->
    <div class="bg-white shadow-md rounded-2xl border border-gray-100 p-8">
        <form method="POST" action="{{ url_for('trainer_routes.record_progress', member_id=member.id) }}">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                <!-- Basic Measurements -->
                <div class="space-y-5">
                    <h3 class="text-lg font-semibold text-gray-900 border-b pb-2 flex items-center">
                        <i class="fas fa-weight text-primary mr-2"></i>Basic Measurements
                    </h3>

                    <div>
                        <label class="block text-gray-700 font-medium mb-2" for="recorded_date">Record Date</label>
                        <input type="date" id="recorded_date" name="recorded_date"
                               value="{{ date.today()|datetimeformat('%Y-%m-%d') }}"
                               class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-primary focus:outline-none">
                    </div>

                    <div>
                        <label class="block text-gray-700 font-medium mb-2" for="weight">Weight (kg)</label>
                        <input type="number" id="weight" name="weight" step="0.1" min="30" max="300"
                               value="{{ last_record.weight if last_record else '' }}"
                               class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-primary focus:outline-none">
                    </div>

                    <div>
                        <label class="block text-gray-700 font-medium mb-2" for="body_fat_percentage">Body Fat Percentage (%)</label>
                        <input type="number" id="body_fat_percentage" name="body_fat_percentage" step="0.1" min="3" max="50"
                               class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-primary focus:outline-none">
                    </div>

                    <div>
                        <label class="block text-gray-700 font-medium mb-2" for="muscle_mass">Muscle Mass (kg)</label>
                        <input type="number" id="muscle_mass" name="muscle_mass" step="0.1" min="10" max="100"
                               class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-primary focus:outline-none">
                    </div>
                </div>

                <!-- Body Measurements -->
                <div class="space-y-5">
                    <h3 class="text-lg font-semibold text-gray-900 border-b pb-2 flex items-center">
                        <i class="fas fa-ruler-horizontal text-primary mr-2"></i>Body Measurements (cm)
                    </h3>

                    <div>
                        <label class="block text-gray-700 font-medium mb-2" for="chest">Chest</label>
                        <input type="number" id="chest" name="chest" step="0.1" min="50" max="200"
                               class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-primary focus:outline-none">
                    </div>

                    <div>
                        <label class="block text-gray-700 font-medium mb-2" for="waist">Waist</label>
                        <input type="number" id="waist" name="waist" step="0.1" min="40" max="150"
                               class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-primary focus:outline-none">
                    </div>

                    <div>
                        <label class="block text-gray-700 font-medium mb-2" for="hips">Hips</label>
                        <input type="number" id="hips" name="hips" step="0.1" min="50" max="200"
                               class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-primary focus:outline-none">
                    </div>

                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <label class="block text-gray-700 font-medium mb-2" for="bicep">Bicep</label>
                            <input type="number" id="bicep" name="bicep" step="0.1" min="15" max="60"
                                   class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-primary focus:outline-none">
                        </div>
                        <div>
                            <label class="block text-gray-700 font-medium mb-2" for="thigh">Thigh</label>
                            <input type="number" id="thigh" name="thigh" step="0.1" min="30" max="100"
                                   class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-primary focus:outline-none">
                        </div>
                    </div>
                </div>
            </div>

            <!-- Notes -->
            <div class="mt-8">
                <label class="block text-gray-700 font-medium mb-2" for="notes">Progress Notes</label>
                <textarea id="notes" name="notes" rows="4"
                          placeholder="Observations, improvements, challenges, recommendations..."
                          class="w-full border border-gray-300 rounded-lg px-4 py-2 focus:ring-2 focus:ring-primary focus:outline-none"></textarea>
            </div>

            <!-- Buttons -->
            <div class="flex justify-end space-x-4 mt-8">
                <a href="{{ url_for('trainer_routes.client_details', member_id=member.id) }}"
                   class="bg-gray-100 text-gray-700 hover:bg-gray-200 px-5 py-2 rounded-lg font-medium transition">
                    <i class="fas fa-times mr-2"></i>Cancel
                </a>
                <button type="submit"
                        class="bg-primary text-white hover:bg-blue-700 px-5 py-2 rounded-lg font-medium shadow-md transition">
                    <i class="fas fa-save mr-2"></i>Record Progress
                </button>
            </div>
        </form>
    </div>

    <!-- Progress Tips -->
    <div class="bg-white shadow-md rounded-2xl border border-gray-100 p-8 mt-8">
        <h3 class="text-xl font-semibold text-gray-900 mb-6 flex items-center">
            <i class="fas fa-lightbulb text-primary mr-2"></i>Progress Tracking Tips
        </h3>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
            <div>
                <h4 class="font-semibold text-gray-900 mb-3">Measurement Guidelines</h4>
                <ul class="space-y-2 text-sm text-gray-700">
                    <li>• Take measurements at consistent times</li>
                    <li>• Use the same equipment for accuracy</li>
                    <li>• Record in a relaxed state</li>
                    <li>• Be consistent with measurement locations</li>
                </ul>
            </div>
            <div>
                <h4 class="font-semibold text-gray-900 mb-3">Client Information</h4>
                <div class="space-y-3 text-sm">
                    <div class="flex justify-between">
                        <span class="text-gray-600">Height:</span>
                        <span class="font-medium">{{ member.height or 'Not recorded' }}{% if member.height %} cm{% endif %}</span>
                    </div>
                    {% if member.fitness_goals %}
                    <div>
                        <span class="text-gray-600">Goals:</span>
                        <div class="font-medium mt-1">{{ member.fitness_goals }}</div>
                    </div>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
